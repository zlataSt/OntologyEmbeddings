{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"gpuClass":"standard","widgets":{"application/vnd.jupyter.widget-state+json":{"2b3989cbaf454b60a95b13221f33f3db":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ed66898992e042bd8823249adb9e0fad","IPY_MODEL_5852258052204524a2adceb87334769c","IPY_MODEL_62271e10ddae46418327e7b593499272"],"layout":"IPY_MODEL_345518f098954ef182d8abee97a6272d"}},"ed66898992e042bd8823249adb9e0fad":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2904d4953e2049cebf30c46feb7dcfea","placeholder":"​","style":"IPY_MODEL_367fbeb252484450a1b0fde125f259f4","value":"Epoch 30 | mean loss: 4.03075: 100%"}},"5852258052204524a2adceb87334769c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b7642ecd87494bd3b996180c161647bd","max":30,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9719249d5ae547a996ef94b2f0d74577","value":30}},"62271e10ddae46418327e7b593499272":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f41c6210993d461d9aa6146faba271bd","placeholder":"​","style":"IPY_MODEL_43627ba50ece494f8c967af1838bb26e","value":" 30/30 [02:32&lt;00:00,  5.00s/epoch]"}},"345518f098954ef182d8abee97a6272d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2904d4953e2049cebf30c46feb7dcfea":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"367fbeb252484450a1b0fde125f259f4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b7642ecd87494bd3b996180c161647bd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9719249d5ae547a996ef94b2f0d74577":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f41c6210993d461d9aa6146faba271bd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"43627ba50ece494f8c967af1838bb26e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1d38afee2e9b4f26bae59e60cf5cc5bf":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_91540cb4a8594da7ab27baec1e8df9dd","IPY_MODEL_d603c22914b246b8bf341ce6132ee8db","IPY_MODEL_94d4e0c7c2294808901c50b5e1166c5b"],"layout":"IPY_MODEL_e08c858a0e734f0d837e65cd9e3cb53f"}},"91540cb4a8594da7ab27baec1e8df9dd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_284c3a64a3f04c71b7c6b0e75c565f75","placeholder":"​","style":"IPY_MODEL_024f799679eb49d9bba949a3c1cec2bc","value":"Link prediction evaluation: 100%"}},"d603c22914b246b8bf341ce6132ee8db":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_457988d04863488fae24425e5a104d16","max":2842,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b0b6c7cd425c48bebbe42b9b1de76b77","value":2842}},"94d4e0c7c2294808901c50b5e1166c5b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ea24eba2158746b0b6aac8d7f00cb711","placeholder":"​","style":"IPY_MODEL_097736f3357b40bd9290952b7cd1e4c7","value":" 2842/2842 [02:11&lt;00:00, 21.63batch/s]"}},"e08c858a0e734f0d837e65cd9e3cb53f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"284c3a64a3f04c71b7c6b0e75c565f75":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"024f799679eb49d9bba949a3c1cec2bc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"457988d04863488fae24425e5a104d16":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b0b6c7cd425c48bebbe42b9b1de76b77":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ea24eba2158746b0b6aac8d7f00cb711":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"097736f3357b40bd9290952b7cd1e4c7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6e1df59fc178440e9c27b4fc54b29c5a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_fe3cff293d614b72b4cf62b34f2f2366","IPY_MODEL_0598a7764306451985afa5a088b08df8","IPY_MODEL_626072b9838b4d25b9ba3bec725e91e0"],"layout":"IPY_MODEL_f06edb42e4474243850878a6c5333938"}},"fe3cff293d614b72b4cf62b34f2f2366":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4377d27345844f2ea85576254e72189b","placeholder":"​","style":"IPY_MODEL_55de01dab47b427bb22a2f49024c2f69","value":"Link prediction evaluation:   0%"}},"0598a7764306451985afa5a088b08df8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"danger","description":"","description_tooltip":null,"layout":"IPY_MODEL_c351f8f5cacc4a2ca0cdc3f652ad8bca","max":4,"min":0,"orientation":"horizontal","style":"IPY_MODEL_5adc7f207f714291a70b8b215f2dc7ad","value":0}},"626072b9838b4d25b9ba3bec725e91e0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_18c5e470e22b48e4af9344706d460971","placeholder":"​","style":"IPY_MODEL_3e0f02a58710443ba3885a4d05a4bbab","value":" 0/4 [00:00&lt;?, ?batch/s]"}},"f06edb42e4474243850878a6c5333938":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4377d27345844f2ea85576254e72189b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"55de01dab47b427bb22a2f49024c2f69":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c351f8f5cacc4a2ca0cdc3f652ad8bca":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5adc7f207f714291a70b8b215f2dc7ad":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"18c5e470e22b48e4af9344706d460971":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3e0f02a58710443ba3885a4d05a4bbab":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"91c53468b2744d3dafac66654c6eb719":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_fde248c365ee4c57aa5c8dc608536bf3","IPY_MODEL_0d816d0d63754c70a35ab3bc0da5b409","IPY_MODEL_780a994e0d6042289d0d8e748bb88c29"],"layout":"IPY_MODEL_c0cc42f59bbb43a4a4b82e7f724f85ba"}},"fde248c365ee4c57aa5c8dc608536bf3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e48da581b3a9401fb555cec0e2a46ead","placeholder":"​","style":"IPY_MODEL_74400c5523b5440189e95f1fcf6f6a8e","value":"Link prediction evaluation: 100%"}},"0d816d0d63754c70a35ab3bc0da5b409":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_735dcc5fc5a94eadae9e420f8595723e","max":15,"min":0,"orientation":"horizontal","style":"IPY_MODEL_623dc025ad88406aa1c8e949d6d42a38","value":15}},"780a994e0d6042289d0d8e748bb88c29":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_492ec0ca88154687b1ed79ff24e4d4c0","placeholder":"​","style":"IPY_MODEL_96d2abaf3e66411192d7bfb9ba89d181","value":" 15/15 [00:00&lt;00:00, 19.46batch/s]"}},"c0cc42f59bbb43a4a4b82e7f724f85ba":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e48da581b3a9401fb555cec0e2a46ead":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"74400c5523b5440189e95f1fcf6f6a8e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"735dcc5fc5a94eadae9e420f8595723e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"623dc025ad88406aa1c8e949d6d42a38":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"492ec0ca88154687b1ed79ff24e4d4c0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"96d2abaf3e66411192d7bfb9ba89d181":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7f5e4b1da53c4068acc627f700be7391":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_b09f443333a6443c8fc0a52f5b91123c","IPY_MODEL_f4f6f0e22c024e6886dac527000ed6e9","IPY_MODEL_514ae004eea24153a8536dc66db66b55"],"layout":"IPY_MODEL_2cef0a14452145e980b66a160684ef60"}},"b09f443333a6443c8fc0a52f5b91123c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_db3fe589ddc544599440f9c6cbb14567","placeholder":"​","style":"IPY_MODEL_a363c0b9b0b64ff4b8bbb2deecff780e","value":"Cross evaluation: 100%"}},"f4f6f0e22c024e6886dac527000ed6e9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0d0a256663ba435dba7cea726207bc41","max":54,"min":0,"orientation":"horizontal","style":"IPY_MODEL_5f5152f4e57848a0ae3b570cf85c22d7","value":54}},"514ae004eea24153a8536dc66db66b55":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6ab085111a564c7f9dca0f8277ecdcdc","placeholder":"​","style":"IPY_MODEL_3b9e19ffc376463284d1040d19cd4615","value":" 54/54 [01:44&lt;00:00,  1.92s/batch]"}},"2cef0a14452145e980b66a160684ef60":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"db3fe589ddc544599440f9c6cbb14567":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a363c0b9b0b64ff4b8bbb2deecff780e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0d0a256663ba435dba7cea726207bc41":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5f5152f4e57848a0ae3b570cf85c22d7":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"6ab085111a564c7f9dca0f8277ecdcdc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3b9e19ffc376463284d1040d19cd4615":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"MVnx6bI8eUsW","executionInfo":{"status":"ok","timestamp":1678898995266,"user_tz":-180,"elapsed":9444,"user":{"displayName":"Александр Кормишенков","userId":"03410401230166460218"}},"outputId":"a6579dc6-9469-45ad-b3ad-1949ae9392f5"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting torchkge\n","  Downloading torchkge-0.17.5-py2.py3-none-any.whl (51 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m51.2/51.2 KB\u001b[0m \u001b[31m1.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tqdm>=4.64 in /usr/local/lib/python3.9/dist-packages (from torchkge) (4.65.0)\n","Requirement already satisfied: pandas>=1.4 in /usr/local/lib/python3.9/dist-packages (from torchkge) (1.4.4)\n","Requirement already satisfied: torch>=1.2.0 in /usr/local/lib/python3.9/dist-packages (from torchkge) (1.13.1+cu116)\n","Requirement already satisfied: numpy>=1.22 in /usr/local/lib/python3.9/dist-packages (from torchkge) (1.22.4)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.9/dist-packages (from pandas>=1.4->torchkge) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.9/dist-packages (from pandas>=1.4->torchkge) (2022.7.1)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.9/dist-packages (from torch>=1.2.0->torchkge) (4.5.0)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.9/dist-packages (from python-dateutil>=2.8.1->pandas>=1.4->torchkge) (1.15.0)\n","Installing collected packages: torchkge\n","Successfully installed torchkge-0.17.5\n"]}],"source":["! pip install torchkge -U"]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive/',force_remount=True)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4sf3KWkFfOWh","executionInfo":{"status":"ok","timestamp":1678899024552,"user_tz":-180,"elapsed":29301,"user":{"displayName":"Александр Кормишенков","userId":"03410401230166460218"}},"outputId":"43b1c8e5-e1fe-4fef-af78-aa068244aab4"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive/\n"]}]},{"cell_type":"code","source":["%cd '/content/drive/MyDrive/joie'"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cjrLCnLQfo55","executionInfo":{"status":"ok","timestamp":1678899024553,"user_tz":-180,"elapsed":10,"user":{"displayName":"Александр Кормишенков","userId":"03410401230166460218"}},"outputId":"61cdc213-7efb-4fd3-9f6f-4a49d6034efe"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/joie\n"]}]},{"cell_type":"code","source":["import torchkge\n","import torch\n","from torchkge.data_structures import KnowledgeGraph,SmallKG\n","import pandas as pd\n","import numpy as np\n","from torch import cuda\n","\n","\n","from torchkge.utils import MarginLoss\n","from torchkge.models.translation import TransEModel, TransHModel\n","from torchkge.models.bilinear import DistMultModel, HolEModel\n","from torchkge.evaluation import LinkPredictionEvaluator\n","from torchkge.sampling import BernoulliNegativeSampler\n","\n","import gc"],"metadata":{"id":"tl1A7_uefwCf"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["datasets = {data: \n","            {\n","              type_kg : \n","                to_structure_kg(f'data/{data}/{data}_{type_kg}.txt') for type_kg in ['insnet','ontonet','instype']\n","             } \n","            for data in ['db', 'yago']\n","          }"],"metadata":{"id":"BNG1ck6UgNvI","colab":{"base_uri":"https://localhost:8080/","height":398},"executionInfo":{"status":"error","timestamp":1678899050650,"user_tz":-180,"elapsed":11,"user":{"displayName":"Александр Кормишенков","userId":"03410401230166460218"}},"outputId":"332405a4-95e3-46b8-d049-00b14ad54a22"},"execution_count":null,"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-6-16b74ccd6058>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m datasets = {data: \n\u001b[0m\u001b[1;32m      2\u001b[0m             {\n\u001b[1;32m      3\u001b[0m               \u001b[0mtype_kg\u001b[0m \u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m                 \u001b[0mto_structure_kg\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34mf'data/{data}/{data}_{type_kg}.txt'\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mtype_kg\u001b[0m \u001b[0;32min\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m'insnet'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'ontonet'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'instype'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m              } \n","\u001b[0;32m<ipython-input-6-16b74ccd6058>\u001b[0m in \u001b[0;36m<dictcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m      1\u001b[0m datasets = {data: \n\u001b[0;32m----> 2\u001b[0;31m             {\n\u001b[0m\u001b[1;32m      3\u001b[0m               \u001b[0mtype_kg\u001b[0m \u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m                 \u001b[0mto_structure_kg\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34mf'data/{data}/{data}_{type_kg}.txt'\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mtype_kg\u001b[0m \u001b[0;32min\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m'insnet'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'ontonet'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'instype'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m              } \n","\u001b[0;32m<ipython-input-6-16b74ccd6058>\u001b[0m in \u001b[0;36m<dictcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m      2\u001b[0m             {\n\u001b[1;32m      3\u001b[0m               \u001b[0mtype_kg\u001b[0m \u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 4\u001b[0;31m                 \u001b[0mto_structure_kg\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34mf'data/{data}/{data}_{type_kg}.txt'\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mtype_kg\u001b[0m \u001b[0;32min\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m'insnet'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'ontonet'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'instype'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      5\u001b[0m              } \n\u001b[1;32m      6\u001b[0m             \u001b[0;32mfor\u001b[0m \u001b[0mdata\u001b[0m \u001b[0;32min\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m'db'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'yago'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'to_structure_kg' is not defined"]}]},{"cell_type":"code","source":["kg_insnet_train, kg_insnet_test = train_test_split_kg(datasets['db']['insnet'], test_size = 0.01, type_split = 'share')\n","kg_ontonet_train, kg_ontonet_test = train_test_split_kg(datasets['db']['ontonet'], test_size = 0.1, type_split = 'share')\n","kg_instype_train, kg_instype_test = train_test_split_kg(datasets['db']['instype'], test_size = 0.1, type_split = 'size')"],"metadata":{"id":"s6bihRrbg80k"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["kg_unit_train = KnowledgeGraph(pd.concat([kg_insnet_train.get_df(), kg_ontonet_train.get_df(), datasets['db']['instype'].get_df()]))\n","test_insnet = prepare_full_graph_compare_joie(kg_unit_train,kg_insnet_test)\n","test_ontonet = prepare_full_graph_compare_joie(kg_unit_train,kg_ontonet_test)\n","test_instype = prepare_full_graph_compare_joie(kg_unit_train,kg_instype_test)"],"metadata":{"id":"ZKfLZzgdmAZ5"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["res_dict = {}"],"metadata":{"id":"nIGQU5OZyfnU"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["**TransE**"],"metadata":{"id":"XMkn9zu3wYuC"}},{"cell_type":"code","source":["model_kge = TransEModel(emb_dim=200, n_entities=kg_unit_train.n_ent, n_relations=kg_unit_train.n_rel)\n","optimizer = torch.optim.Adam(model_kge.parameters(), lr=0.001)\n","criterion = MarginLoss(0.5)\n","trainer = Trainer(\n","    model=model_kge, criterion=criterion, kg_train=kg_unit_train, n_epochs=30, \n","    batch_size=1024, optimizer=optimizer, \n","    sampling_type='bern', use_cuda='all')"],"metadata":{"id":"neGO4oZhnx0E"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["trainer.run()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["2b3989cbaf454b60a95b13221f33f3db","ed66898992e042bd8823249adb9e0fad","5852258052204524a2adceb87334769c","62271e10ddae46418327e7b593499272","345518f098954ef182d8abee97a6272d","2904d4953e2049cebf30c46feb7dcfea","367fbeb252484450a1b0fde125f259f4","b7642ecd87494bd3b996180c161647bd","9719249d5ae547a996ef94b2f0d74577","f41c6210993d461d9aa6146faba271bd","43627ba50ece494f8c967af1838bb26e"]},"id":"fMBuevoHpMtt","executionInfo":{"status":"ok","timestamp":1671495317218,"user_tz":-180,"elapsed":152783,"user":{"displayName":"Александр Кормишенков","userId":"03410401230166460218"}},"outputId":"4e3cdcf0-ad4f-48ed-ed68-0c3922188082"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/30 [00:00<?, ?epoch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"2b3989cbaf454b60a95b13221f33f3db"}},"metadata":{}}]},{"cell_type":"code","source":["print('Точность на instance')\n","evaluator = LinkPredictionEvaluator(model_kge, test_insnet)\n","evaluator.evaluate(b_size=16)\n","evaluator.print_results()\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":591,"referenced_widgets":["1d38afee2e9b4f26bae59e60cf5cc5bf","91540cb4a8594da7ab27baec1e8df9dd","d603c22914b246b8bf341ce6132ee8db","94d4e0c7c2294808901c50b5e1166c5b","e08c858a0e734f0d837e65cd9e3cb53f","284c3a64a3f04c71b7c6b0e75c565f75","024f799679eb49d9bba949a3c1cec2bc","457988d04863488fae24425e5a104d16","b0b6c7cd425c48bebbe42b9b1de76b77","ea24eba2158746b0b6aac8d7f00cb711","097736f3357b40bd9290952b7cd1e4c7","6e1df59fc178440e9c27b4fc54b29c5a","fe3cff293d614b72b4cf62b34f2f2366","0598a7764306451985afa5a088b08df8","626072b9838b4d25b9ba3bec725e91e0","f06edb42e4474243850878a6c5333938","4377d27345844f2ea85576254e72189b","55de01dab47b427bb22a2f49024c2f69","c351f8f5cacc4a2ca0cdc3f652ad8bca","5adc7f207f714291a70b8b215f2dc7ad","18c5e470e22b48e4af9344706d460971","3e0f02a58710443ba3885a4d05a4bbab"]},"id":"yzmDa37qqMJj","executionInfo":{"status":"error","timestamp":1671495769552,"user_tz":-180,"elapsed":132021,"user":{"displayName":"Александр Кормишенков","userId":"03410401230166460218"}},"outputId":"06914e0a-a22f-4b12-d5dc-5c8c96b4c241"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Точность на instance\n"]},{"output_type":"display_data","data":{"text/plain":["Link prediction evaluation:   0%|          | 0/2842 [00:00<?, ?batch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1d38afee2e9b4f26bae59e60cf5cc5bf"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Hit@10 : 0.205 \t\t Filt. Hit@10 : 0.209\n","Mean Rank : 9986 \t Filt. Mean Rank : 9969\n","MRR : 0.092 \t\t Filt. MRR : 0.096\n","Точность на ontology\n"]},{"output_type":"display_data","data":{"text/plain":["Link prediction evaluation:   0%|          | 0/4 [00:00<?, ?batch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6e1df59fc178440e9c27b4fc54b29c5a"}},"metadata":{}},{"output_type":"error","ename":"OutOfMemoryError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mOutOfMemoryError\u001b[0m                          Traceback (most recent call last)","\u001b[0;32m<ipython-input-25-be6511a8aa28>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      6\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'Точность на ontology'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      7\u001b[0m \u001b[0mevaluator\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mLinkPredictionEvaluator\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel_kge\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtest_ontonet\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 8\u001b[0;31m \u001b[0mevaluator\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mevaluate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mb_size\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m64\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      9\u001b[0m \u001b[0mevaluator\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mprint_results\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     10\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.8/dist-packages/torchkge/evaluation.py\u001b[0m in \u001b[0;36mevaluate\u001b[0;34m(self, b_size, verbose)\u001b[0m\n\u001b[1;32m    295\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfilt_rank_true_tails\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mi\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0mb_size\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mi\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0mb_size\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mget_rank\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfilt_scores\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mt_idx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdetach\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    296\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 297\u001b[0;31m             \u001b[0mscores\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0minference_scoring_function\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcandidates\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mt_emb\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mr_emb\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    298\u001b[0m             \u001b[0mfilt_scores\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfilter_scores\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mscores\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkg\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdict_of_heads\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mt_idx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mr_idx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mh_idx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    299\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrank_true_heads\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mi\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0mb_size\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mi\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0mb_size\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mget_rank\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mscores\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mh_idx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdetach\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.8/dist-packages/torchkge/models/interfaces.py\u001b[0m in \u001b[0;36minference_scoring_function\u001b[0;34m(self, proj_h, proj_t, r)\u001b[0m\n\u001b[1;32m    258\u001b[0m                 \u001b[0mr_\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mr\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mview\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mb_size\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mr\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    259\u001b[0m                 \u001b[0mt_\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mproj_t\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mview\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mb_size\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mr\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 260\u001b[0;31m                 \u001b[0;32mreturn\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdissimilarity\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mproj_h\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0mr_\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mt_\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    261\u001b[0m         \u001b[0;32melif\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mr\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;36m3\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    262\u001b[0m             \u001b[0;31m# this is the relation prediction case\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.8/dist-packages/torchkge/utils/dissimilarities.py\u001b[0m in \u001b[0;36ml2_dissimilarity\u001b[0;34m(a, b)\u001b[0m\n\u001b[1;32m     23\u001b[0m     \"\"\"\n\u001b[1;32m     24\u001b[0m     \u001b[0;32massert\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0ma\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mb\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 25\u001b[0;31m     \u001b[0;32mreturn\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0ma\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0mb\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mnorm\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mp\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdim\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     26\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     27\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mOutOfMemoryError\u001b[0m: CUDA out of memory. Tried to allocate 4.69 GiB (GPU 0; 14.76 GiB total capacity; 12.12 GiB already allocated; 895.75 MiB free; 13.32 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF"]}]},{"cell_type":"code","source":["gc.collect()\n","torch.cuda.empty_cache()\n","print('Точность на ontology')\n","evaluator = LinkPredictionEvaluator(model_kge, test_ontonet)\n","evaluator.evaluate(b_size=16)\n","evaluator.print_results()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":122,"referenced_widgets":["91c53468b2744d3dafac66654c6eb719","fde248c365ee4c57aa5c8dc608536bf3","0d816d0d63754c70a35ab3bc0da5b409","780a994e0d6042289d0d8e748bb88c29","c0cc42f59bbb43a4a4b82e7f724f85ba","e48da581b3a9401fb555cec0e2a46ead","74400c5523b5440189e95f1fcf6f6a8e","735dcc5fc5a94eadae9e420f8595723e","623dc025ad88406aa1c8e949d6d42a38","492ec0ca88154687b1ed79ff24e4d4c0","96d2abaf3e66411192d7bfb9ba89d181"]},"id":"0MLkkX_N6wqf","executionInfo":{"status":"ok","timestamp":1671495970322,"user_tz":-180,"elapsed":1709,"user":{"displayName":"Александр Кормишенков","userId":"03410401230166460218"}},"outputId":"372b7c51-8214-4104-ee82-cbec45c56ff2"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Точность на ontology\n"]},{"output_type":"display_data","data":{"text/plain":["Link prediction evaluation:   0%|          | 0/15 [00:00<?, ?batch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"91c53468b2744d3dafac66654c6eb719"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Hit@10 : 0.553 \t\t Filt. Hit@10 : 0.563\n","Mean Rank : 1082 \t Filt. Mean Rank : 1081\n","MRR : 0.34 \t\t Filt. MRR : 0.351\n"]}]},{"cell_type":"code","source":["gc.collect()\n","torch.cuda.empty_cache()\n","\n","print('Точность на cross')\n","evaluator_cross_view = CrossEvaluator(model_kge, test_instype)\n","evaluator_cross_view.evaluate(b_size=124)\n","print('Hit@10: {:.4f}'.format(evaluator_cross_view.hit_at_k(k=10)))\n","print('Hit@3: {:.4f}'.format(evaluator_cross_view.hit_at_k(k=3)))\n","print('Hit@1: {:.4f}'.format(evaluator_cross_view.hit_at_k(k=1)))\n","print('MRR: {:.4f}'.format(evaluator_cross_view.mrr()))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":141,"referenced_widgets":["7f5e4b1da53c4068acc627f700be7391","b09f443333a6443c8fc0a52f5b91123c","f4f6f0e22c024e6886dac527000ed6e9","514ae004eea24153a8536dc66db66b55","2cef0a14452145e980b66a160684ef60","db3fe589ddc544599440f9c6cbb14567","a363c0b9b0b64ff4b8bbb2deecff780e","0d0a256663ba435dba7cea726207bc41","5f5152f4e57848a0ae3b570cf85c22d7","6ab085111a564c7f9dca0f8277ecdcdc","3b9e19ffc376463284d1040d19cd4615"]},"id":"pOxMdqg26yZn","executionInfo":{"status":"ok","timestamp":1671496431951,"user_tz":-180,"elapsed":104879,"user":{"displayName":"Александр Кормишенков","userId":"03410401230166460218"}},"outputId":"bebc6a71-0879-457f-b241-ecac29edc383"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Точность на cross\n"]},{"output_type":"display_data","data":{"text/plain":["Cross evaluation:   0%|          | 0/54 [00:00<?, ?batch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"7f5e4b1da53c4068acc627f700be7391"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Hit@10: 0.0012\n","Hit@3: 0.0001\n","Hit@1: 0.0000\n","MRR: 0.0105\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"xwdiHxwv-O1u"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["**DistMult**"],"metadata":{"id":"ezes2Th9xKns"}},{"cell_type":"code","source":["model_kge = DistMultModel(emb_dim=200, n_entities=kg_unit_train.n_ent, n_relations=kg_unit_train.n_rel)\n","optimizer = torch.optim.Adam(model_kge.parameters(), lr=0.001)\n","criterion = MarginLoss(0.5)\n","trainer = Trainer(\n","    model=model_kge, criterion=criterion, kg_train=kg_unit_train, n_epochs=30, \n","    batch_size=2048, optimizer=optimizer, \n","    sampling_type='bern', use_cuda='None')"],"metadata":{"id":"xg3OkKACqLfp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["trainer.run()"],"metadata":{"id":"BFn1ZQBwxPBf"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["gc.collect()\n","torch.cuda.empty_cache()\n","\n","print('Точность на instance')\n","evaluator = LinkPredictionEvaluator(model_kge, test_insnet)\n","evaluator.evaluate(b_size=16)\n","evaluator.print_results()\n","\n","\n","gc.collect()\n","torch.cuda.empty_cache()\n","print('Точность на ontology')\n","evaluator = LinkPredictionEvaluator(model_kge, test_ontonet)\n","evaluator.evaluate(b_size=16)\n","evaluator.print_results()\n","\n","gc.collect()\n","torch.cuda.empty_cache()\n","\n","print('Точность на cross')\n","evaluator_cross_view = CrossEvaluator(model_kge, test_instype)\n","evaluator_cross_view.evaluate(b_size=64)\n","print('Hit@3: {:.4f}'.format(evaluator_cross_view.hit_at_k(k=3)))\n","print('Hit@1: {:.4f}'.format(evaluator_cross_view.hit_at_k(k=1)))\n","print('MRR: {:.4f}'.format(evaluator_cross_view.mrr()))"],"metadata":{"id":"4yhkzDqYxQ-k"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["**HolE**"],"metadata":{"id":"xkK_D6omxVE2"}},{"cell_type":"code","source":["model_kge = HolEModel(emb_dim=200, n_entities=kg_unit_train.n_ent, n_relations=kg_unit_train.n_rel)\n","optimizer = torch.optim.Adam(model_kge.parameters(), lr=0.001)\n","criterion = MarginLoss(0.5)\n","trainer = Trainer(\n","    model=model_kge, criterion=criterion, kg_train=kg_unit_train, n_epochs=30, \n","    batch_size=2048, optimizer=optimizer, \n","    sampling_type='bern', use_cuda='None')"],"metadata":{"id":"h9gv9cByxW4Y"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["trainer.run()"],"metadata":{"id":"C7LvtKYgxZNx"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["gc.collect()\n","torch.cuda.empty_cache()\n","\n","print('Точность на instance')\n","evaluator = LinkPredictionEvaluator(model_kge, test_insnet)\n","evaluator.evaluate(b_size=16)\n","evaluator.print_results()\n","\n","\n","gc.collect()\n","torch.cuda.empty_cache()\n","print('Точность на ontology')\n","evaluator = LinkPredictionEvaluator(model_kge, test_ontonet)\n","evaluator.evaluate(b_size=16)\n","evaluator.print_results()\n","\n","gc.collect()\n","torch.cuda.empty_cache()\n","\n","print('Точность на cross')\n","evaluator_cross_view = CrossEvaluator(model_kge, test_instype)\n","evaluator_cross_view.evaluate(b_size=64)\n","print('Hit@3: {:.4f}'.format(evaluator_cross_view.hit_at_k(k=3)))\n","print('Hit@1: {:.4f}'.format(evaluator_cross_view.hit_at_k(k=1)))\n","print('MRR: {:.4f}'.format(evaluator_cross_view.mrr())) "],"metadata":{"id":"VM6saJLjxdpJ"},"execution_count":null,"outputs":[]}]}